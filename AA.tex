\documentclass[10pt,a4paper]{report}
\usepackage[colorlinks=true,linkcolor=blue,bookmarks=false]{hyperref}
\usepackage{amsfonts}
\usepackage[intlimits]{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{enumerate}
\usepackage{tcolorbox}

\usepackage{pgfplots}
\pgfplotsset{compat=1.8}
\usepgfplotslibrary{external}
\tikzexternalize

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem*{theorem*}{Theorem}
\theoremstyle{plain}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{definition}
\newtheorem{tutorial}{Tutorial}[section]
\newtheorem{example}{Example}[section]
\theoremstyle{plain}

\newcommand{\dd}{\mathop{}\,\mathrm{d}}
\newcommand{\DD}{\mathop{}\,\mathrm{D}}
\newcommand{\ddns}{\mathrm{d}}
\newcommand{\deriv}[2]{\dfrac{\dd #1}{\dd #2}}
\newcommand{\parderiv}[2]{\dfrac{\partial #1}{\partial #2}}

\newenvironment{problem}{\par\begin{tcolorbox}\textbf{Problem}\\*}{\end{tcolorbox}}
\newenvironment{solution}{\par\textbf{Solution}\\*}{{\par\centering\rule{3cm}{.1pt}\par}}
\newenvironment{colvectorenvironment}{\left(\!\!\!\begin{array}{c}}{\end{array}\!\!\!\right)}
\newenvironment{notes}{\textsc{Notes:}\begin{enumerate}[1)]}{\end{enumerate}}

\newenvironment{proofenv}{\begin{proof}}{\end{proof}{\par\centering\rule{3cm}{.1pt}\par}}

%\newcommand{\qed}{\nobreak \ifvmode \relax \else
%      \ifdim\lastskip<1.5em \hskip-\lastskip
%      \hskip1.5em plus0em minus0.5em \fi \nobreak
%      \vrule height0.75em width0.5em depth0.25em\fi}
      
\newcommand{\me}{\mathrm{e}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\mlet}{\text{let}\,}
\newcommand{\suchthat}{\mathop{}\colon\,}
\newcommand{\domain}{\mathcal{D}}
\newcommand{\curl}[1]{\nabla\!\times\!#1}
\newcommand{\colvector}[1]{\begin{colvectorenvironment}#1\end{colvectorenvironment}}
\newcommand{\crossnormal}[3]{\left(\parderiv{\vec{#1}}{#2} \times \parderiv{\vec{#1}}{#3} \right)}
\newcommand{\vecprime}[1]{\vec{#1}^{\,\prime}}

\renewcommand{\implies}{\Rightarrow}
\renewcommand\qedsymbol{$\blacksquare$}

\begin{document}
\parindent0pt

\title{Advanced Analysis - Examples and Tutorials}
\date{\today}
\maketitle

\tableofcontents

\chapter{Surface Integrals}
\section{Surface Integrals}
\begin{example}\ 
    \begin{problem}
        Consider a cone parametrised by:
        \[
            \vec{r}(u,v) =
            \begin{colvectorenvironment}
                v\cos u\\
                v\sin u\\
                v
            \end{colvectorenvironment}\quad
            u\in[0,2\pi],\,
            v\in[0,1]
        \]
        with a distribution of mass per unit area given by $f(x,y) = 1-x$. Find the total mass of the cone.
    \end{problem}
    
    \begin{solution}
        We need to find
        \[
            \iint_S f\dd a
        \]
        \[\begin{array}{lcr}
            \parderiv{\vec{r}}{u} =
            \begin{colvectorenvironment}
                -v\sin u\\
                v\cos u\\
                0
            \end{colvectorenvironment}
            &\qquad&
            \parderiv{\vec{r}}{v} =
            \begin{colvectorenvironment}
                \cos u\\
                \sin u\\
                1
            \end{colvectorenvironment}
        \end{array}\]
        \begin{eqnarray*}
            \parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v} &=&
            \left|\left(\begin{array}{ccc}
                \hat{i} & \hat{j} & \hat{k}\\
                -v\sin u & v\cos u & 0\\
                \cos u & \sin u & 1
            \end{array}\right)\right|\\
            &=&
            \begin{colvectorenvironment}
                v\cos u\\
                v\sin u\\
                -v
            \end{colvectorenvironment}\\
            \left\| \parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v} \right\| &=&
            \sqrt{v^2\cos^2u + v^2\sin^2u + v^2}\\
            &=&\sqrt2v
        \end{eqnarray*}
        
        \begin{flalign*}
            \iint_S f\dd a &= \iint_D f(\vec{r}) \left\| \parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v} \right\| \dd u\ddns v&&\\
            &= \int_0^1 \int_{u=0}^{2\pi} (1-v\cos u)\sqrt2v \dd u\ddns v &&\\
            &= \int_0^1 \int_{u=0}^{2\pi} \sqrt2v - \sqrt2v^2\cos u\dd u\ddns v &&\\
            &= \sqrt2 \int_0^1 \left.uv - v^2\sin u\right|_{u=0}^{2\pi} \dd v &&\\
            &= \sqrt2 \int_0^1 2\pi v\dd v &&\\
            &= \left. \sqrt2\pi v^2\right|_0^1 &&\\
            &= \sqrt2\pi
        \end{flalign*}
    \end{solution}
\end{example}

\begin{example}\ 
    \begin{problem}
        Find the area of the paraboloid given by
        \[
            x^2 + y^2 = az \quad a>0,\,z\in[0,h]
        \]
    \end{problem}
    \begin{solution}
        First we take the parametrisation of the paraboloid as
        \[
            \vec{r} =
            \begin{colvectorenvironment}
                v\cos u\\
                v\sin u\\
                \frac{v^2}{a}
            \end{colvectorenvironment}\qquad
            u\in[0,2\pi],\,v\in[0,\sqrt{ah}]
        \]
        Now,
        \begin{flalign*}
            \parderiv{\vec{r}}{u} &=
                \begin{colvectorenvironment}
                    -v\sin u\\
                    v\cos u\\
                    0
                \end{colvectorenvironment} &&\\
            \parderiv{\vec{r}}{v} &=
                \begin{colvectorenvironment}
                    \cos u\\
                    \sin u\\
                    2\frac{v}{a}
                \end{colvectorenvironment}\\
        \end{flalign*}
        \begin{flalign*}
            \parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v} &= 
                \left|\left(\begin{array}{ccc}
                    \hat{i} &   \hat{j} &   \hat{k} \\
                    -v\sin u&   v\cos u &   0       \\
                    \cos u  &   \sin u  &   2\frac{v}{a}
                \end{array}\right)\right| &&\\
            &=
                \begin{colvectorenvironment}
                    \frac{2v^2\cos u}{a}\\
                    \frac{2v^2\sin u}{a}\\
                    -v
                \end{colvectorenvironment} &&\\
            \left\|\parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v}\right\| &=
                \sqrt{\dfrac{4v^4}{a^2} \left( \cos^2u + \sin^2u \right) + v^2} &&\\
            &=
                \sqrt{\dfrac{4v^4}{a^2} + v^2}
        \end{flalign*}
        
        \begin{flalign*}
            \text{Area} &= \iint_S\ddns a &&\\
             &= \int_0^{\sqrt{ah}} \int_{u=0}^{2\pi} \sqrt{\dfrac{4v^4}{a^2} + v^2} \dd u \ddns v &&\\
             &= 2\pi \int_0^{\sqrt{ah}} \sqrt{\dfrac{4v^4}{a^2} + v^2} \dd v &&\\
             &= 2\pi \int_0^{\sqrt{ah}} \frac{v}{a} \sqrt{4v^2+a^2} \dd v &&\\
             &&&\\
             \mlet s &= \sqrt{4v^2+a^2}&&\\
             \therefore \dd s &= \frac{4v}{\sqrt{4v^2+a^2}}\dd v &&\\
             \therefore \text{Area} &= 2\pi \int_{v=0}^{\sqrt{ah}} \frac{s^2}{4a} \dd s &&\\
             &= \left.\frac{\pi}{6a} s^3 \right|_{v=0}^{\sqrt{ah}} &&\\
             &= \left.\frac{\pi}{6a} (4v^2+a^2)^{\frac{3}{2}} \right|_{v=0}^{\sqrt{ah}} &&\\
             &= \frac{\pi}{6a} \left((4ah+a^2)^{\frac{3}{2}} - a^3\right) &&
        \end{flalign*}
    \end{solution}
\end{example}

\pagebreak
\begin{example}\ 
    \begin{problem}
        Find the area of the triangle with vertices $(0,0,0),\,(1,0,2),\,(0,2,6)$.
    \end{problem}
    \begin{solution}\\*
        First we must parametrise our triangle:
        \begin{flushleft}\begin{tikzpicture}
            \begin{axis}[
                xlabel = {$x$},
                ylabel = {$y$},
                zlabel = {$z$},
                xtick=data,
                ytick=data,
                ztick=data,
                grid=major]
                \addplot3[patch, color=blue, fill=blue, shader=flat, opacity=0.5] coordinates {(0,0,0) (1,0,2) (0,2,6)};
            \end{axis}
        \end{tikzpicture}\end{flushleft}
        
        \begin{flalign*}
            \vec{r} &= u\begin{colvectorenvironment}1\\0\\2\end{colvectorenvironment} + v \begin{colvectorenvironment}0\\2\\6\end{colvectorenvironment} &&\\
            &= \begin{colvectorenvironment}u\\2v\\2u+6v\end{colvectorenvironment} &&
        \end{flalign*}
        
        We can see that $u=0\implies v\in[0,1]$ and $v=0 \implies u\in[0,1]$. So we now have our limits for the cases of $u=0$ and $v=0$, but now we must
        find the limits for $u,v\neq0$.
        
        First we fix $u\in(0,1]$, and find $\max v$ which gives us a resultant vector that lies on the line parametrised by:
        \begin{eqnarray*}
            \vec{r} &=& \begin{colvectorenvironment}1\\0\\2\end{colvectorenvironment} + \lambda\left(
            \begin{colvectorenvironment}0\\2\\6\end{colvectorenvironment} - \begin{colvectorenvironment}1\\0\\2\end{colvectorenvironment}\right)
            \quad\lambda\in[0,1]\\
            \begin{colvectorenvironment}u\\2v\\2u+6v\end{colvectorenvironment} &=&
            \begin{colvectorenvironment}1-\lambda \\ 2\lambda \\ 2 + 4\lambda\end{colvectorenvironment}
        \end{eqnarray*}
        
        \begin{flalign*}
            2v &= 2\lambda &&\\
            \therefore v &= \lambda &&\\
            u &= 1-\lambda &&\\
            \implies v &= 1-u &&
        \end{flalign*}
        
        Therefore for a fixed $u$ $\max v$ is given by $(1-u)$, which gives us our final parametrisation as:
        \begin{flalign*}
            \vec{r} &= \begin{colvectorenvironment}u\\2v\\2u+6v\end{colvectorenvironment}\qquad u\in[0,1],\, v\in[0,1-u]&&
        \end{flalign*}
        
        \begin{eqnarray*}
            \parderiv{\vec{r}}{u} &=& \begin{colvectorenvironment}1\\0\\2\end{colvectorenvironment}\\
            \parderiv{\vec{r}}{v} &=& \begin{colvectorenvironment}0\\2\\6\end{colvectorenvironment}\\
            \parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v} &=& \begin{colvectorenvironment}-4\\-6\\2\end{colvectorenvironment}\\
            \left\|\parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v}\right\|
                &=& \sqrt{16+36+4}\\
                &=& 2\sqrt{14}
        \end{eqnarray*}
        
        Now,
        \begin{flalign*}
            \text{Area} \Delta &= \iint_\Delta \ddns a &&\\
            &= \int_0^1 \int_{v=0}^{1-u} 2\sqrt{14} \dd v \ddns u &&\\
            &= \int_0^1 2\sqrt{14}(1-u) \dd u &&\\
            &= \left. 2\sqrt{14}u - \sqrt{14}u^2 \right|_0^1 &&\\
            &= \sqrt{14} &&
        \end{flalign*}
    \end{solution}
\end{example}

\begin{example}\ 
    \begin{problem}
        Let
        \[
            \vec{F}(x,y,z) = \begin{colvectorenvironment}2x\\y\\z\end{colvectorenvironment}
        \]
        and let $S$ be the surface $z=(1+x)y^2$ with normal having positive $z$-component, $x\in[0,1],\,y\in[0,2]$.\\*
        Find $\iint\limits_S\vec{F}\cdot\ddns\vec{a}$
    \end{problem}
    \begin{solution}
        \begin{flushleft}
            \begin{tikzpicture}
                \begin{axis}[]
                    \addplot3[surf, color=blue, fill=blue, shader=flat, opacity=0.5, samples=50, domain=0:1, domain y=0:2]
                        {(1+x)*y^2};
                \end{axis}
            \end{tikzpicture}
        \end{flushleft}
        \[
            \vec{r}(u,v) = \begin{colvectorenvironment}u\\v\\(1+u)v^2\end{colvectorenvironment}\qquad u\in[0,1],\,v\in[0,2]
        \]
        \begin{flalign*}
            \parderiv{\vec{r}}{u} &= \begin{colvectorenvironment}1\\0\\v^2\end{colvectorenvironment} &&\\
            \parderiv{\vec{r}}{v} &= \begin{colvectorenvironment}0\\1\\2(1+u)v\end{colvectorenvironment} &&
        \end{flalign*}
        \begin{flalign*}
            \parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v} &=
                \left|\begin{array}{ccc}
                    \hat{i} & \hat{j} & \hat{k}\\
                    1 & 0 & v^2\\
                    0 & 1 & 2(1+u)v
                \end{array}\right| &&\\
            &= \begin{colvectorenvironment}-v^2\\-2(1+u)v\\1\end{colvectorenvironment} &&
        \end{flalign*}
        
        Furthermore:
        \begin{flalign*}
            \vec{F}(\vec{r}(u,v)) &= \begin{colvectorenvironment}2u\\v\\(1+u)v^2\end{colvectorenvironment} &&
        \end{flalign*}
        
        Therefore,
        \begin{flalign*}
            \iint_S\vec{F}\cdot\ddns\vec{a} &= \int_0^2 \int_0^1 \begin{colvectorenvironment}2u\\v\\(1+u)v^2\end{colvectorenvironment} \cdot \begin{colvectorenvironment}-v^2\\-2(1+u)v\\1\end{colvectorenvironment} \dd u\ddns v&&\\
            &= \int_0^2 \int_0^1 -2uv^2 - 2v^2 -2uv^2 + v^2 + uv^2 \dd u\ddns v &&\\
            &= \int_0^2 \int_0^1 -3uv^2 - v^2 \dd u\ddns v &&\\
            &= \int_0^2 \left. -\frac{3}{2}u^2v^2-uv^2 \right|_{u=0}^1 \dd v &&\\
            &= \int_0^2 -\frac{5}{2}v^2\dd v &&\\
            &= \left. -\frac{5}{6}v^3 \right|_0^2 &&\\
            &= -\frac{20}{3} &&
        \end{flalign*}
    \end{solution}
\end{example}

\begin{example}\ 
    \begin{problem}
        Let $S$ be a surface and $\vec{F}$ be a vector field such that for each $\vec{x}\in S$, $\vec{F}(\vec{x})$ is tangent
        to $S$ at $\vec{x}$. Prove that $\iint\limits_S\vec{F}\cdot\ddns\vec{a} = 0$.
    \end{problem}
    \begin{solution}
        Since $\vec{F}(\vec{x})$ is tangential to $S\mathop{}\,\forall \vec{x}\in S$.
        \[
            \therefore \vec{F}\!\perp\vec{n}\quad\forall\vec{n}
        \]
        In particular,
        \begin{flalign*}
            &\vec{F}(\vec{r}(u,v))\!\perp\left(\parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v}\right)&&\\
            \implies&\vec{F}(\vec{r}(u,v))\cdot\left(\parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v}\right) = 0&&\\
            \therefore &\iint_S\vec{F}\cdot\ddns\vec{a} = \iint_S\vec{F}(\vec{r}(u,v))\cdot\left(\parderiv{\vec{r}}{u}\times\parderiv{\vec{r}}{v}\right)\dd u\ddns v &&\\
            &\iint_S\vec{F}\cdot\ddns\vec{a} = 0 &&
        \end{flalign*}
        \qed
    \end{solution}
\end{example}

\begin{example}\ 
    \begin{problem}
        Let $\vec{F}(x,y,z) = \begin{colvectorenvironment}x\\y\\z\end{colvectorenvironment}$ and $S = \{(x,y,z)\suchthat x^2+y^2+z^2=1\}$. Let $S$ be oriented such that the normal
        to $S$ points outward. Evaluate $\iint\limits_S\vec{F}\cdot\ddns\vec{a}$
    \end{problem}
    \begin{solution}
        \begin{tikzpicture}
            \begin{axis}[scale mode=scale uniformly, xmin=-1.5, xmax=1.5, ymin=-1.5, ymax=1.5, zmin=-1.5, zmax=1.5, width=20cm, axis lines=middle, view={45}{30}]
                \addplot3[surf, domain=0:2*pi, domain y=0:pi, samples=60, samples y=60, opacity=0.1, fill=blue, shader=flat, color=blue]
                    ({sin(deg(y))*cos(deg(x))}, {sin(deg(y))*sin(deg(x))}, {cos(deg(y))});
                \addplot3[mark=none, color=red] coordinates {(0,0,0) (0.5,0.5,{cos(45)})};
                \addplot3[only marks, color=red, mark=oplus*] coordinates {(0.5,0.5,{cos(45)})};
                \addplot3[mark=none] coordinates {(0,0,0) (0.5,0.5,0) (0.5,0.5,{cos(45)})};
                \addplot3[mark=none, domain=0:45, samples=15, samples y=0] ({0.3*cos(x)},{0.3*sin(x)},0);
                \addplot3[mark=none, domain=0:45, samples=15, samples y=0] ({0.3*sin(x)*cos(45)},{0.3*sin(45)*sin(x)},{0.3*cos(x)});
            \end{axis}
        \end{tikzpicture}
        \[
            \begin{array}{l}
                x = R\sin{v}\cos{u}\\
                y = R\sin{v}\sin{u}\\
                z = R\cos{v}
            \end{array}\qquad
            \begin{array}{l}
                u\in[0,2\pi]\\
                v\in[0,\pi]
            \end{array}
        \]
        \begin{flalign*}
            \vec{r}(u,v) &= \begin{colvectorenvironment}\sin{v}\cos{u}\\\sin{v}\sin{u}\\\cos{v}\end{colvectorenvironment} &&\\
            \parderiv{\vec{r}}{u} &= \begin{colvectorenvironment}-\sin{u}\sin{v}\\\cos{u}\sin{v}\\0\end{colvectorenvironment} &&\\
            \parderiv{\vec{r}}{v} &= \begin{colvectorenvironment}\cos{u}\cos{v}\\\sin{u}\cos{v}\\-\sin{v}\end{colvectorenvironment} &&\\
            \parderiv{\vec{r}}{u} \times \parderiv{\vec{r}}{v} &= \begin{colvectorenvironment}-\cos{u}\sin^2{v}\\-\sin{u}\sin^2{v}\\-\sin{v}\cos{v}\end{colvectorenvironment} &&\\
            &= -\sin{\!(v)}\vec{r}(u,v)&&
        \end{flalign*}
        but this normal vector is oriented inwards. So instead we take
        \[
            \vec{n} = -\left(\parderiv{\vec{r}}{u} \times \parderiv{\vec{r}}{v}\right) = \sin{\!(v)}\vec{r}(u,v)
        \]
        
        So,
        \begin{flalign*}
            \vec{F}(\vec{r}(u,v)) &= \vec{r}(u,v) &&\\
            \iint_S\vec{F}\cdot\ddns\vec{a} &= \int_0^{2\pi} \int_{v=0}^\pi \vec{r}(u,v)\cdot(\sin{\!(v)}\vec{r}(u,v))\dd v\ddns u &&\\
            &= \int_0^{2\pi} \int_{v=0}^\pi \sin{v} \left\|\vec{r}(u,v)\right\|^2 \dd v\ddns u &&\\
            &= \int_0^{2\pi} \int_{v=0}^\pi \sin{v} \dd v\ddns u &&\\
            &= \int_0^{2\pi} \left.-\cos{v}\right|_{v=0}^\pi \dd u &&\\
            &= \int_0^{2\pi} 2 \dd u &&\\
            &= \left. 2u\right|_0^{2\pi} &&\\
            &= 4\pi &&
        \end{flalign*}
    \end{solution}
\end{example}

\begin{tikzpicture}
    \begin{axis}
        \addplot3[surf, shader=flat] {(x^2+y^2)^(1/2)};
    \end{axis}
\end{tikzpicture}

\section{Stoke's Theorem}

\begin{theorem}[Green's Theorem]\label{thm:1-1}\ \\*
    Let $\domain \subset \real^2$ have boundary $\partial\domain$ that is positively oriented\footnote{counter-clockwise in the $xy$-plane}
    and piecewise smooth, let $p_1,p_2\colon\domain\to\real$ be continuously differentiable, then
    \[
        \iint_\domain \left( \DD_1p_2 - \DD_2p_1 \right) \dd u\ddns v
        = \int_{\partial\domain}\begin{colvectorenvironment}p_1\\p_2\end{colvectorenvironment} \cdot \ddns\vec{\gamma}
    \]
\end{theorem}

\begin{theorem}[Stoke's Theorem]\label{thm:1-2}\ \\*
    Let $S$ be an oriented surface with a piecewise smooth boundary $\partial S$ and let $\vec{F}\colon \real^3\to\real^3$ be continuously
    differentiable, then
    \[
        \iint_S \left( \curl{\vec{F}} \right) \cdot \ddns\vec{a} = \int_{\partial S}\vec{F}\cdot\ddns\vec{\gamma}
    \]

    \begin{notes}
        \item
            Stoke's Theorem relates infinitesimal rotation of the vector field $\vec{F}$ over $S$ to the (macroscopic) circulation/rotation
            of $\vec{F}$ along the boundary of $S$.
        \item
            Stoke's Theorem is the generalization of Green's Theorem to 3 dimensions.
    \end{notes}
\end{theorem}

\begin{proofenv}\ \\*
    To prove that Stoke's Theorem reduces to Green's Theorem, we define:
    \[
        \vec{F} = \begin{colvectorenvironment}p_1\\p_2\\0\end{colvectorenvironment}
        \qquad
        \vec{r} = \begin{colvectorenvironment}x\\y\\0\end{colvectorenvironment}
    \]
    
    \begin{eqnarray*}
        \parderiv{\vec{r}}{x} \times \parderiv{\vec{r}}{y} &=&
            \left|\begin{array}{ccc}
                \hat{i} &   \hat{j} &   \hat{k} \\
                1       &   0       &   0       \\
                0       &   1       &   0
            \end{array}\right| \\
        &=& \colvector{0\\0\\1}
    \end{eqnarray*}
    
    \begin{eqnarray*}
        \curl{\vec{F}} &=&
            \left|\begin{array}{ccc}
                \hat{i}         &   \hat{j}         &   \hat{k}         \\
                \parderiv{}{x}  &   \parderiv{}{y}  &   \parderiv{}{z}  \\
                p_1             &   p_2             &   0
            \end{array}\right| \\
        &=& \colvector{0\\0\\\DD_1p_2 - \DD_2p_1}
    \end{eqnarray*}
    
    \begin{eqnarray*}
        \therefore \iint_\domain \left( \curl{\vec{F}} \right) \cdot \ddns\vec{a}
        &=& \iint_\domain \colvector{0\\0\\\DD_1p_2 - \DD_2p_1} \cdot \colvector{0\\0\\1} \dd x\ddns y\\
        &=& \iint_\domain \DD_1p_2-\DD_2p_1\dd x\ddns y
    \end{eqnarray*}
    which is Green's Theorem.
\end{proofenv}

\begin{proofenv} \nameref{thm:1-2}\\*
    Let $\vec{r}(u,v)$ be a parametrisation of $S$.\\*
    Let $\vec{\alpha}\colon [a,b] \to \real^2$ be a parametrisation of $\partial\domain$.\\*
    Then $\vec{\gamma}(t) = \vec{r}(\vec{\alpha}(t))\quad t\in[a,b]$ is a parametrisation of $\partial S$, and this gives us
    an orientation-preserving parametrisation of the boundary of $S$.
    
    We must show that
    \[
        \iint_\domain\curl{\vec{F}}(\vec{r}(u,v)) \cdot \crossnormal{r}{u}{v} \dd u\ddns v
        =
        \int_a^b\vec{F}(\vec{\gamma}(t)) \cdot \vec{\gamma}^\prime(t) \dd t
    \]
    
    Note:
    \begin{eqnarray}
        \curl{\vec{F}}(\vec{r}(u,v)) \cdot \crossnormal{r}{u}{v}
        &=&
        \sum_{i,j=1}^3 \parderiv{\vec{F_i}}{x_j} \left(
            \parderiv{\vec{r_i}}{v}\parderiv{\vec{r_j}}{u} - \parderiv{\vec{r_j}}{v}\parderiv{\vec{r_i}}{u}
            \right) \label{thm:1-2-1}
    \end{eqnarray}
    
    Now,
    \begin{flalign*}
        & \int_a^b \vec{F}(\vec{\gamma}(t)) \cdot \vecprime{\gamma}(t) \dd t &&\\
        =& \int_a^b \vec{F}(\vec{r}(\vec{\alpha}(t))) \cdot (\vecprime{r} (\vec{\alpha}(t)) \vecprime{\alpha}(t)) \dd t &&\\
        =& \int_a^b \left( (\vec{F} \circ \vec{r}\,)(\vec{\alpha}(t)) \right)^\top
            \left( \vecprime{r}(\vec{\alpha}(t))\vecprime{\alpha}(t) \right) \dd t &&\\
        =& \left( \left( (\vec{F}\circ \vec{r}\,)(\vec{\alpha}(t)) \right)^\top \vecprime{r}(\vec{\alpha}(t)) \right)^\top \cdot \vecprime{\alpha}(t) \dd t&&\\
        =& \int_{\partial\domain} \left( (\vec{F}\circ\vec{r})^\top\vecprime{r} \right)^\top \cdot\ddns\vec{\alpha} &&\\
        =& \int_{\partial\domain} \left( (\vecprime{r})^\top (\vec{F} \circ \vec{r}) \right)\cdot\ddns\vec{\alpha} &&\\
        =& \int_{\partial\domain}
            \left(\begin{array}{ccc}
                \parderiv{r_1}{u} & \parderiv{r_2}{u} & \parderiv{r_3}{u} \\&&\\
                \parderiv{r_1}{v} & \parderiv{r_2}{v} & \parderiv{r_3}{v} 
            \end{array}\right)
            \colvector{F_1 \circ \vec{r} \\ F_2 \circ \vec{r} \\ F_3 \circ \vec{r}}
            \cdot\ddns\vec{\alpha} &&\\
        =& \int_{\partial\domain} \colvector{
                \sum\limits_{i=1}^3 \parderiv{r_i}{u} (F_i \circ \vec{r})\\
                \sum\limits_{i=1}^3 \parderiv{r_i}{v} (F_i \circ \vec{r})}
            \cdot\ddns\vec{\alpha}&& \\
        =& \iint_\domain \left(
            \parderiv{}{u}\left( \sum_{i=1}^3 \parderiv{r_i}{v} (F_i\circ\vec{r}) \right)
            -
            \parderiv{}{v}\left( \sum_{i=1}^3 \parderiv{r_i}{u} (F_i\circ\vec{r}) \right)
            \right) \dd u\ddns v
            \qquad \text{(By \nameref{thm:1-1})}&&\\
        =& \iint_\domain \sum_{i=1}^3 \left(
            \left( \parderiv{^2r_i}{u\partial v} (F_i\circ\vec{r}) + \parderiv{r_i}{v} \parderiv{(F_i\circ\vec{r})}{u} \right)
            -
            \left( \parderiv{^2r_i}{v\partial u} (F_i\circ\vec{r}) + \parderiv{r_i}{u} \parderiv{(F_i\circ\vec{r})}{v} \right)
            \right) \dd u\ddns v &&
    \end{flalign*}
    \begin{flalign*}
        =& \iint_\domain \sum_{i=1}^3 \left(
            \parderiv{r_i}{v} \parderiv{(F_i\circ\vec{r})}{u} - \parderiv{r_i}{u} \parderiv{(F_i\circ\vec{r})}{v}
            \right) \dd u \ddns v &&\\
        =& \iint_\domain \sum_{i=1}^3 \left(
            \parderiv{r_i}{v} \sum_{j=1}^3 \parderiv{F_i}{x_j} \parderiv{r_j}{u}
            -
            \parderiv{r_i}{u} \sum_{j=1}^3 \parderiv{F_i}{x_j} \parderiv{r_j}{v}
            \right) \dd u \ddns v &&\\
        =& \iint_\domain \sum_{i,j = 1}^3 \parderiv{F_i}{x_j} \left(
            \parderiv{r_i}{v}\parderiv{r_j}{u} - \parderiv{r_j}{v}\parderiv{r_i}{u}
            \right) \dd u \ddns v &&\\
        =& \iint_\domain \curl{\vec{F}}(\vec{r}(u,v)) \cdot \crossnormal{r}{u}{v} \dd u\ddns v && \text{\eqref{thm:1-2-1}}
    \end{flalign*}
\end{proofenv}



















\end{document}